<%

	--[[
		Info	系统状态
		Author	Wangchao  <wangchao123.com@gmail.com>
		Copyright	2012
	]]--

	local board_type = luci.version.distversion

	local status = require "luci.tools.status"
	
	--网关


	local ver  = require "luci.version"

	local random = math.random()
	
	--是否显示过 密码
	local showpassword_tag = "0"
	local showpasswordfile = "/etc/app/showpassword_cache"
	local fd = io.open(showpasswordfile, "r")

	


-%>	
<%+header%>
<style>
.datatable{width:100%;margin: 0;padding: 0;border: 1}
.datatable tr{height:40px;line-height: 40px;
	border-bottom-style: dotted;
 }
.wan_ipv6_li{display: none;}
.lan_ipv6_li{display:none}
.t1{width:25%;vertical-align: top}
#need_upgrade{display: none;}
</style>

<div data-role="collapsible-set" data-theme="" data-content-theme="">
	<div data-role="collapsible" data-collapsed="">
		<h3>  系统信息 </h3>
		<div data-role="fieldcontain">
			<fieldset data-role="controlgroup">
			<table class="datatable">
			<tr>
				<td class="t1"><b>系统版本：<%=pcdata(luci.version.distname)%> <%=pcdata(luci.version.distversion)%></b></td>

				<div id="need_upgrade"><span  style="background-image: url(<%=resource%>/web/images/alert.png);background-repeat:no-repeat; 
					text-align: left; padding: 5px 5px 5px 33px; background-position: 5px 50%; 
					background-repeat: no-repeat no-repeat;">有更新,<a href="#" onclick="switch_interface_type('web','<%=luci.dispatcher.build_url("admin")%>?act=options&param=system/upgrade&<%=random%>');">现在升级</a></span>
				</div>					
				</td>
			</tr>
			<tr>
				<td class="t1"><b>系统状态：<%=luci.sys.exec("uptime")%></b></td>
			</tr>
			
			</table>
			</fieldset>
		</div>
	</div>
</div>
<div data-role="collapsible-set" data-theme="" data-content-theme="">
	<div data-role="collapsible" data-collapsed="">
		<h3> 互联网 </h3>
		<div data-role="fieldcontain">
			<fieldset data-role="controlgroup">
			<table class="datatable">
			<tr>
				<td class="t1"><b>IPv4地址</b></td>
				<td style="height:20px;line-height: 20px"><span id="wan_ip"> 

					</span> <span id="wan_mask"><%=luci.sys.exec("ifconfig eth1|grep 'inet addr'|awk -F '[ :]' '{print $13}'")%></span> 
					<span id="wan_type"> </span>
				</td>
			</tr>
			<tr class="wan_ipv6_li">
				<td class="t1"><b>IPv6地址</b></td>
				<td style="height:20px;line-height: 20px">
					<span id="wan_ipv6"></span> 
				</td>
			</tr>
			<tr>
				<td class="t1"><b>MAC地址</b></td>
				<td><span id="wan_mac"><%=luci.sys.exec("ifconfig eth1 |awk -F '[ :]+' 'NR==1 {print $6$7$8$9$10$11}'")%></span></td>
			</tr>

			</table>
			</fieldset>
		</div>
	</div>
</div>
<div data-role="collapsible-set" data-theme="" data-content-theme="">
	<div data-role="collapsible" data-collapsed="">
		<h3>  局域网 </h3>
		<div data-role="fieldcontain">
			<fieldset data-role="controlgroup">
			<table class="datatable">
			<tr>
				<td class="t1"><b>IPv4地址</b></td>
				<td><span id="lan_ipv4"><%=luci.sys.exec("ifconfig br-lan|grep 'inet addr'|awk -F '[ :]' '{print $13}'")%></span></td>
			</tr>
			<tr class="lan_ipv6_li">
				<td class="t1"><b>IPv6地址</b></td>
				<td style="height:20px;line-height: 20px"><span id="lan_ipv6">获取中...</span></td>
			</tr>
			<tr>
				<td class="t1"><b>MAC地址</b></td>
				<td><span id="lan_mac"><%=luci.sys.exec("ifconfig eth0 |awk -F '[ :]+' 'NR==1 {print $6$7$8$9$10$11}'")%></span></td>
			</tr>
			</table>
			</fieldset>
		</div>
	</div>
</div>

<div data-role="collapsible-set" data-theme="" data-content-theme="">
	<div data-role="collapsible" data-collapsed="">
		<h3>  无线网络 </h3>
		<div data-role="fieldcontain">
			<fieldset data-role="controlgroup">
			<table class="datatable">
			<tr class="wifi_other">
				<td class="t1"><b>网络名称</b></td>
				<td><span id="wifi_ssid"><%=luci.sys.exec("uci get wireless.@wifi-iface[0].ssid")%></span></td>
			</tr>
			<tr class="wifi_other">
				<td class="t1"><b>安全类型</b></td>
				<td><span id="wifi_encryption"><%=luci.sys.exec("uci get wireless.cfg033579.encryption")%></span></td>
			</tr>
			<tr class="wifi_other">
				<td class="t1"><b>无线信道</b></td>
				<td><span id="wifi_channel"><%=luci.sys.exec("uci get wireless.@wifi-device[0].channel")%></span></td>
			</tr>
			</table>
			</fieldset>
		</div>
	</div>
</div>

<%+footer%>